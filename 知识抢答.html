<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InSAR å¹´ä¼šçŸ¥è¯†æŠ¢ç­”ç³»ç»Ÿ (2åˆ†é’Ÿç‰ˆ)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --primary: #38bdf8;
            --accent: #f472b6;
            --text: #f8fafc;
        }
        body { margin: 0; font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; }
        
        /* é€šç”¨æ ·å¼ */
        .hidden { display: none !important; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: #000; }
        .btn-primary:hover { filter: brightness(1.1); }
        
        /* === è§†å›¾ 1: æ€»æ§ä»ªè¡¨ç›˜ (Dashboard) === */
        #view-dashboard { padding: 40px; text-align: center; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto; }
        .card { background: var(--card); padding: 20px; border-radius: 15px; border: 1px solid #334155; transition: transform 0.2s; }
        .card:hover { transform: translateY(-5px); border-color: var(--primary); }
        .card h3 { color: var(--primary); margin-top: 0; }
        .mini-qr { margin: 15px auto; background: white; padding: 10px; width: 120px; height: 120px; border-radius: 8px; }
        
        /* === è§†å›¾ 2: å¤§å±å±•ç¤ºç«¯ (Screen) === */
        #view-screen { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .screen-content { text-align: center; width: 80%; max-width: 1000px; z-index: 2; }
        .q-tag { background: var(--accent); color: white; padding: 5px 15px; border-radius: 20px; font-size: 1.2rem; margin-bottom: 20px; display: inline-block; }
        .q-text { font-size: 2.5rem; font-weight: bold; line-height: 1.4; margin-bottom: 40px; text-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        
        /* äºŒç»´ç å¼¹çª— */
        .qr-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10; display: flex; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(10px); }
        .big-qr { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 0 50px var(--primary); }
        
        /* é€‰é¡¹æ˜¾ç¤º */
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; text-align: left; }
        .option-box { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; font-size: 1.5rem; border: 2px solid transparent; }
        .option-box.correct { background: #22c55e; color: black; font-weight: bold; border-color: #86efac; box-shadow: 0 0 30px #22c55e; }
        
        /* === è§†å›¾ 3: æ‰‹æœºç­”é¢˜ç«¯ (Mobile) === */
        #view-mobile { padding: 20px; min-height: 100vh; background: #000; text-align: center; }
        .m-header { font-size: 1.2rem; color: var(--primary); margin-bottom: 20px; }
        .m-q-text { font-size: 1.2rem; margin-bottom: 30px; line-height: 1.5; }
        .m-btn { display: block; width: 100%; padding: 15px; margin-bottom: 15px; background: #334155; border: none; color: white; border-radius: 10px; font-size: 1.1rem; }
        .m-btn:active { background: var(--primary); color: black; }
        .m-btn.selected { background: var(--primary); color: black; border: 2px solid white; }

        /* åŠ¨ç”» */
        .fade-in { animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="view-dashboard" class="hidden">
        <h1 style="font-size: 3rem; margin-bottom: 40px;">ğŸ›°ï¸ InSAR çŸ¥è¯†æŠ¢ç­”æ€»æ§å°</h1>
        <p style="color: #94a3b8; margin-bottom: 40px;">ç‚¹å‡»å¡ç‰‡è¿›å…¥å¤§å±æ¨¡å¼ï¼Œæˆ–ç›´æ¥è®©é€‰æ‰‹æ‰«æä¸‹æ–¹äºŒç»´ç ç»ƒä¹ </p>
        <div class="grid-container" id="dash-grid"></div>
    </div>

    <div id="view-screen" class="hidden">
        <div style="position: absolute; top: 20px; left: 20px; opacity: 0.5;">
            <button class="btn" onclick="goHome()">ğŸ  è¿”å›æ€»æ§</button>
        </div>

        <div class="screen-content fade-in">
            <div class="q-tag" id="s-index">Q1</div>
            <div class="q-text" id="s-text">é¢˜ç›®åŠ è½½ä¸­...</div>
            
            <div class="options-grid hidden" id="s-options">
                </div>
        </div>

        <div id="s-qr-layer" class="qr-overlay hidden">
            <h2 style="font-size: 3rem; margin-bottom: 20px; color: white;">è¯·æ‰«æäºŒç»´ç æŠ¢ç­”</h2>
            <div id="s-qr-code" class="big-qr"></div>
            <div style="margin-top: 30px; font-size: 2rem; color: var(--primary); font-weight: bold;">
                â³ å€’è®¡æ—¶: <span id="s-timer">120</span>s
            </div>
            <div style="margin-top: 20px; color: #94a3b8; font-size: 1.2rem;">æŒ‰ [ç©ºæ ¼é”®] ç»“æŸæŠ¢ç­”å¹¶çœ‹ç­”æ¡ˆ</div>
        </div>

        <div style="position: absolute; bottom: 20px; color: #64748b;">
            [ç©ºæ ¼] æµç¨‹æ§åˆ¶ï¼šå‡ºé¢˜ -> äºŒç»´ç  -> å¼€å¥– | [Esc] è¿”å›
        </div>
    </div>

    <div id="view-mobile" class="hidden">
        <div class="m-header" id="m-index">ç¬¬ 1 é¢˜</div>
        <div class="m-q-text" id="m-text">é¢˜ç›®...</div>
        <div id="m-options"></div>
        <div id="m-status" style="margin-top: 30px; color: #4ade80; font-weight: bold;"></div>
    </div>

<script>
    // === é¢˜åº“æ•°æ® ===
    const questions = [
        { q: "åœ¨ SNAPã€SARscape ç­‰è½¯ä»¶è¿›è¡Œå¹²æ¶‰å¤„ç†æ—¶ï¼Œç¬¬ä¸€æ­¥é€šå¸¸æ˜¯å¯¹ä¸¤æ™¯ SAR å½±åƒè¿›è¡Œä»€ä¹ˆæ“ä½œï¼Ÿ", a: ["ç›¸ä½è§£ç¼ ", "é…å‡† (Coregistration)", "å»å¹³åœ°æ•ˆåº”", "åœ°ç†ç¼–ç "], c: 1 },
        { q: "åœ¨å¤„ç† InSAR æ¡çº¹å›¾å™ªå£°æ—¶ï¼Œæœ€è‘—åçš„ Goldstein æ»¤æ³¢ç®—æ³•ä¸»è¦æ˜¯åœ¨å“ªä¸ªåŸŸè¿›è¡Œæ“ä½œçš„ï¼Ÿ", a: ["æ—¶åŸŸ", "é¢‘åŸŸ (Frequency Domain)", "ç©ºé—´åŸŸ", "è‰²å½©åŸŸ"], c: 1 },
        { q: "åœ¨ GAMMA æˆ– SARscape ä¸­è¿›è¡Œç›¸ä½è§£ç¼  (Unwrapping) æ—¶ï¼Œæœ€ç»å…¸ä¸”å¸¸ç”¨çš„ç®—æ³•æ¨¡å‹æ˜¯ï¼Ÿ", a: ["MCF (æœ€å°è´¹ç”¨æµ)", "KNN (K-è¿‘é‚»)", "SVM (æ”¯æŒå‘é‡æœº)", "RGB è‰²å½©å¹³è¡¡"], c: 0 },
        { q: "åœ¨ D-InSARï¼ˆåŒè½¨æ³•ï¼‰æµç¨‹ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å¯¼å…¥å¤–éƒ¨ DEM (æ•°å­—é«˜ç¨‹æ¨¡å‹)ï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯ï¼Ÿ", a: ["æ¨¡æ‹Ÿå¹¶å»é™¤åœ°å½¢ç›¸ä½", "è®¡ç®—å«æ˜Ÿè½¨é“é«˜åº¦", "ç¾åŒ–è¾“å‡ºç»“æœ", "å»é™¤å¤§æ°”è¯¯å·®"], c: 0 },
        { q: "åœ¨ä½¿ç”¨è½¯ä»¶å¤„ç† Sentinel-1 æ•°æ®æ—¶ï¼Œç”±äºå…¶ç‹¬ç‰¹çš„æˆåƒæ¨¡å¼ï¼Œå¿…é¡»è¿›è¡Œå“ªé¡¹ç‰¹æ®Šçš„é¢„å¤„ç†æ­¥éª¤ï¼Ÿ", a: ["Deburst (å»çªå‘/æ‹¼æ¥)", "De-noise (å»å™ª)", "Sharpen (é”åŒ–)", "Crop (è£å‰ª)"], c: 0 },
        { q: "å½“æˆ‘ä»¬åœ¨è½¯ä»¶ä¸­å¾—åˆ°è§†çº¿å‘ï¼ˆLOSï¼‰å½¢å˜åï¼Œè‹¥è¦ç»“åˆå‡é™è½¨æ•°æ®è§£ç®—å‚ç›´å’Œä¸œè¥¿å‘å½¢å˜ï¼Œä¸»è¦åˆ©ç”¨äº†å‡é™è½¨çš„ä»€ä¹ˆå·®å¼‚ï¼Ÿ", a: ["æ³¢é•¿ä¸åŒ", "é£è¡Œæ–¹å‘å’Œå…¥å°„è§’å‡ ä½•å·®å¼‚", "å«æ˜Ÿå“ç‰Œä¸åŒ", "æˆåƒæ—¶é—´ä¸åŒ"], c: 1 },
        { q: "å½“å½¢å˜è¿‡å¤§ï¼ˆå¦‚å¼ºéœ‡ï¼‰å¯¼è‡´å¹²æ¶‰æ¡çº¹è¿‡å¯†æ— æ³•è§£ç¼ æ—¶ï¼Œè½¯ä»¶ä¸­é€šå¸¸æ”¹ç”¨ä»€ä¹ˆæŠ€æœ¯æ¥æå–å½¢å˜ï¼Ÿ", a: ["Offset-tracking (åç§»é‡è¿½è¸ª)", "PS-InSAR", "SBAS-InSAR", "æåŒ–åˆ†è§£"], c: 0 },
        { q: "SBAS å¤„ç†æµç¨‹çš„æœ€åé˜¶æ®µï¼Œä¸ºäº†å»é™¤å¤§æ°”ç›¸ä½ï¼ˆAPSï¼‰ï¼Œè½¯ä»¶é€šå¸¸åˆ©ç”¨äº†å¤§æ°”åœ¨ç©ºé—´å’Œæ—¶é—´ä¸Šçš„ä»€ä¹ˆç‰¹æ€§ï¼Ÿ", a: ["ç©ºé—´é«˜é¢‘ï¼Œæ—¶é—´ä½é¢‘", "ç©ºé—´ä½é¢‘ï¼Œæ—¶é—´é«˜é¢‘", "å®Œå…¨éšæœºå™ªå£°", "ç©ºé—´æ—¶é—´éƒ½æ˜¯å¸¸æ•°"], c: 1 },
        { q: "SBAS-InSAR æŠ€æœ¯çš„æ ¸å¿ƒç­–ç•¥æ˜¯æ„å»ºâ€œå°åŸºçº¿é›†â€ç½‘ç»œï¼Œæœ€æ ¹æœ¬çš„ç‰©ç†ç›®çš„æ˜¯ä¸ºäº†æœ€å¤§é™åº¦åœ°æŠ‘åˆ¶å“ªä¸¤ç§å¤±ç›¸å¹²ç°è±¡ï¼Ÿ", a: ["å¤§æ°”ä¸ç”µç¦»å±‚å¤±ç›¸å¹²", "ç©ºé—´ä¸æ—¶é—´å¤±ç›¸å¹²", "åœ°å½¢ä¸å¹³åœ°å¤±ç›¸å¹²", "å¤šæ™®å‹’ä¸çƒ­å™ªå£°"], c: 1 },
        { q: "Stacking-InSAR é€šè¿‡åŠ æƒå¹³å‡ä¼°ç®—å½¢å˜é€Ÿç‡ï¼Œè¿™ä¸€æ“ä½œæœ‰æ•ˆçš„å‰ææ˜¯å‡è®¾å¤§æ°”ç›¸ä½è¯¯å·®åœ¨æ—¶é—´åŸŸä¸Šç¬¦åˆä»€ä¹ˆç»Ÿè®¡ç‰¹å¾ï¼Ÿ", a: ["éšæ—¶é—´çº¿æ€§å¢é•¿", "éšæœºåˆ†å¸ƒä¸”å‡å€¼ä¸ºé›¶", "å‘ˆå­£èŠ‚æ€§å‘¨æœŸå˜åŒ–", "ä¸åœ°å½¢é«˜åº¦ä¸¥æ ¼ç›¸å…³"], c: 1 }
    ];

    // === æ ¸å¿ƒé€»è¾‘ ===
    const urlParams = new URLSearchParams(window.location.search);
    const mode = urlParams.get('mode') || 'dashboard'; // dashboard, screen, mobile
    const qId = parseInt(urlParams.get('q')) || 0;

    // è·å–åŸºç¡€URL
    const baseUrl = window.location.origin + window.location.pathname;

    window.onload = function() {
        if (mode === 'mobile') initMobile();
        else if (mode === 'screen') initScreen();
        else initDashboard();
    };

    // --- 1. ä»ªè¡¨ç›˜é€»è¾‘ ---
    function initDashboard() {
        document.getElementById('view-dashboard').classList.remove('hidden');
        const grid = document.getElementById('dash-grid');
        
        questions.forEach((q, idx) => {
            const card = document.createElement('div');
            card.className = 'card';
            
            const mobileUrl = `${baseUrl}?mode=mobile&q=${idx}`;
            
            card.innerHTML = `
                <h3>ç¬¬ ${idx + 1} é¢˜</h3>
                <div style="font-size:0.9rem; height:50px; overflow:hidden; margin-bottom:10px;">${q.q}</div>
                <div id="dash-qr-${idx}" class="mini-qr"></div>
                <button class="btn btn-primary" style="width:100%" onclick="openScreen(${idx})">ğŸ“º å¼€å¯å¤§å±</button>
                <div style="margin-top:10px; font-size:0.8rem; color:#64748b;">æ‰‹æœºå…¥å£</div>
            `;
            grid.appendChild(card);
            
            new QRCode(document.getElementById(`dash-qr-${idx}`), {
                text: mobileUrl, width: 100, height: 100
            });
        });
    }

    function openScreen(idx) {
        window.location.href = `${baseUrl}?mode=screen&q=${idx}`;
    }

    // --- 2. å¤§å±é€»è¾‘ ---
    let screenState = 0; // 0=è¯»é¢˜, 1=äºŒç»´ç , 2=ç­”æ¡ˆ
    function initScreen() {
        document.getElementById('view-screen').classList.remove('hidden');
        const q = questions[qId];
        
        document.getElementById('s-index').innerText = `ç¬¬ ${qId + 1} / ${questions.length} é¢˜`;
        document.getElementById('s-text').innerText = q.q;
        
        const optContainer = document.getElementById('s-options');
        const letters = ['A', 'B', 'C', 'D'];
        q.a.forEach((opt, i) => {
            const div = document.createElement('div');
            div.className = 'option-box';
            div.id = `opt-${i}`;
            div.innerText = `${letters[i]}. ${opt}`;
            optContainer.appendChild(div);
        });

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') nextScreenState();
            if (e.code === 'Escape') goHome();
        });
    }

    function nextScreenState() {
        const qrLayer = document.getElementById('s-qr-layer');
        const optContainer = document.getElementById('s-options');
        
        if (screenState === 0) {
            // çŠ¶æ€0 -> 1: æ˜¾ç¤ºäºŒç»´ç 
            screenState = 1;
            qrLayer.classList.remove('hidden');
            const mobileUrl = `${baseUrl}?mode=mobile&q=${qId}`;
            document.getElementById('s-qr-code').innerHTML = "";
            new QRCode(document.getElementById('s-qr-code'), {
                text: mobileUrl, width: 250, height: 250
            });
            startTimer();
        } else if (screenState === 1) {
            // çŠ¶æ€1 -> 2: éšè—äºŒç»´ç ï¼Œæ˜¾ç¤ºé€‰é¡¹å’Œç­”æ¡ˆ
            screenState = 2;
            qrLayer.classList.add('hidden');
            optContainer.classList.remove('hidden');
            const correctIdx = questions[qId].c;
            document.getElementById(`opt-${correctIdx}`).classList.add('correct');
        } else if (screenState === 2) {
            // çŠ¶æ€2 -> ä¸‹ä¸€é¢˜
            if(qId < questions.length - 1) {
                window.location.href = `${baseUrl}?mode=screen&q=${qId + 1}`;
            } else {
                alert('æ‰€æœ‰é¢˜ç›®å·²ç»“æŸï¼');
                goHome();
            }
        }
    }

    function startTimer() {
        let t = 120; // æ”¹ä¸º120ç§’
        const el = document.getElementById('s-timer');
        el.innerText = t; // åˆå§‹åŒ–æ˜¾ç¤º
        
        const timerInt = setInterval(() => {
            if (screenState !== 1) { clearInterval(timerInt); return; }
            t--;
            el.innerText = t;
            if (t <= 0) nextScreenState(); // è‡ªåŠ¨ç»“æŸ
        }, 1000);
    }

    // --- 3. æ‰‹æœºç«¯é€»è¾‘ ---
    function initMobile() {
        document.getElementById('view-mobile').classList.remove('hidden');
        const q = questions[qId];
        
        document.getElementById('m-index').innerText = `æŠ¢ç­”ç¬¬ ${qId + 1} é¢˜`;
        document.getElementById('m-text').innerText = q.q;
        
        const container = document.getElementById('m-options');
        const letters = ['A', 'B', 'C', 'D'];
        
        q.a.forEach((opt, i) => {
            const btn = document.createElement('button');
            btn.className = 'm-btn';
            btn.innerText = `${letters[i]}. ${opt.split(' ')[0]}`;
            btn.onclick = () => submitAnswer(i, btn);
            container.appendChild(btn);
        });
    }

    function submitAnswer(idx, btnEl) {
        const allBtns = document.querySelectorAll('.m-btn');
        allBtns.forEach(b => {
            b.disabled = true;
            b.style.opacity = 0.5;
        });
        btnEl.style.opacity = 1;
        btnEl.classList.add('selected');
        document.getElementById('m-status').innerText = "âœ… ç­”æ¡ˆå·²æäº¤ï¼Œè¯·çœ‹å¤§å±ï¼";
    }

    function goHome() {
        window.location.href = baseUrl;
    }
</script>
</body>
</html>